<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Form Transaksi Otomatis</title>
</head>
<body>
  <h2>Form Penjualan</h2>

  <label for="barang">Nama Barang:</label>
  <select id="barang">
    <option value="">-- Pilih Barang --</option>
  </select><br><br>

  <label for="harga">Harga Satuan:</label>
  <input type="number" id="harga" readonly><br><br>

  <label for="qty">QTY:</label>
  <input type="number" id="qty"><br><br>

  <label for="total">Total:</label>
  <input type="number" id="total" readonly><br><br>

  <script>
    const spreadsheetId = '1SJ-ifJ0BqOHPT3ypCboMTnmj0kwxQyQMe4aI6mOf18Q';
    const apiKey = 'AIzaSyBVqkpDLAw93U0FxrWHj5qh1cNkMmw6xCk';

    const barangSelect = document.getElementById('barang');
    const hargaInput = document.getElementById('harga');
    const qtyInput = document.getElementById('qty');
    const totalInput = document.getElementById('total');

    let hargaList = {}; // Objek untuk menyimpan data harga dari sheet 'harga'

    // Ambil data barang dari sheet 'data'
    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/data!A2:A?key=${apiKey}`)
      .then(response => response.json())
      .then(data => {
        data.values.forEach(row => {
          const option = document.createElement('option');
          option.value = row[0];
          option.textContent = row[0];
          barangSelect.appendChild(option);
        });
      });

    // Ambil harga dari sheet 'harga' (nama barang + harga)
    fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/harga!A2:B?key=${apiKey}`)
      .then(response => response.json())
      .then(data => {
        data.values.forEach(row => {
          const nama = row[0];
          const harga = parseInt(row[1]);
          hargaList[nama] = harga;
        });
      });

    // Saat barang dipilih, isi harga otomatis
    barangSelect.addEventListener('change', () => {
      const barangDipilih = barangSelect.value;
      const harga = hargaList[barangDipilih] || 0;
      hargaInput.value = harga;
      hitungTotal();
    });

    // Saat qty diubah, hitung total
    qtyInput.addEventListener('input', hitungTotal);

    function hitungTotal() {
      const harga = parseInt(hargaInput.value) || 0;
      const qty = parseInt(qtyInput.value) || 0;
      totalInput.value = harga * qty;
    }
  </script>
</body>
</html>
